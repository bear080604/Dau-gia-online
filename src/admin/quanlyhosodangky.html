<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Hồ Sơ Đăng Ký Đấu Giá</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
    body {
    font-family: 'Arial', sans-serif;
    margin: 20px;
    background-color: #f5f7fa;
    color: #333;
}
table {
    width: 100%;
    border-collapse: collapse;
    background-color: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
th, td {
    border: 1px solid #e0e0e0;
    padding: 12px;
    text-align: left;
    font-size: 14px;
}
th {
    text-align: left;
    padding: 1rem;
    font-weight: 600;
    color: #6b7280;
    font-size: 0.85rem;
    text-transform: uppercase;
    border-bottom: 1px solid #e5e7eb;
    background-color: #f9fafb;
    white-space: nowrap;
}
.actions button {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    margin-right: 5px;
}
.approve { background-color: #22c55e; color: #fff; }
.reject { background-color: #ef4444; color: #fff; }
.detail { background-color: #4f46e5; color: #fff; }
.refund { background-color: #ffc107; color: #fff; }
.modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    padding-top: 60px;
}
.modal-content {
    background-color: #fff;
    margin: 5% auto;
    padding: 20px;
    border: 1px solid #ddd;
    width: 80%;
    max-width: 600px;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}
.close:hover, .close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}
textarea {
    width: 100%;
    height: 100px;
    margin-bottom: 10px;
    border-radius: 4px;
    border: 1px solid #ddd;
    padding: 8px;
}
.detail-content {
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.detail-content div {
    padding: 12px;
    background-color: #f8f9fa;
    /* border-radius: 4px; */
    /* border: 1px solid #e0e0e0; */
}
.detail-content label {
    font-weight: 600;
    color: #495057;
    margin-right: 10px;
}
.head{
    display: flex;
    justify-content:flex-start;
    gap: 20px;
    padding: 20px 0px;
}
select{
    border: 1px solid rgb(191, 189, 189);
    padding: 10px 15px;
    border-radius: 5px;
}
.refund{
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
}
</style>
</head>
<body>

<h1>Quản Lý Hồ Sơ Đăng Ký Đấu Giá</h1>

<div class="head">
    <div class="filter">
        <select name="" id="">
            <option value="">Trạng thái</option>
            <option value="">Chờ duyệt</option>
            <option value="">Đã duyệt</option>
            <option value="">Từ chối</option>
        </select>
    </div>
    <div class="sort">
        <select name="" id="">
            <option value="">Sắp xếp theo: </option>
            <option value="">Mới nhất </option>
            <option value="">Cũ nhất </option>
        </select>
    </div>
</div>

<table id="registrationTable">
    <thead>
        <tr>
            <th>Phiên Đấu Giá</th>
            <th>Tài Liệu Liên Quan</th>
            <th>User</th>
            <th>Tiền Đặt Trước</th>
            <th>Trạng Thái</th>
            <th>Thao Tác</th>
        </tr>
    </thead>
    <tbody>
        <!-- Dữ liệu mẫu -->
        
        <tr data-id="2">
            <td>Phiên 002</td>
            <td><a href="document2.pdf">document2.pdf</a></td>
            <td>user2@example.com</td>
            <td>10,000,000 VND</td>
            <td>Chờ Duyệt</td>
            <td class="actions">
                <button class="approve" onclick="approveRegistration(2)"><i class="fa fa-check" aria-hidden="true"></i></button>
                <button class="reject" onclick="openRejectModal(2)"><i class="fa fa-times" aria-hidden="true"></i></button>
                <button class="detail" onclick="openDetailModal(2)"><i class="fa fa-eye" aria-hidden="true"></i></button>
            </td>
        </tr>
    </tbody>
</table>

<!-- Modal Từ Chối -->
<div id="rejectModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeRejectModal()">&times;</span>
        <h2>Từ Chối Hồ Sơ</h2>
        <p>Nhập lý do từ chối:</p>
        <textarea id="rejectReason"></textarea>
        <button onclick="submitReject()">Xác Nhận</button>
    </div>
</div>

<!-- Modal Chi Tiết Thanh Toán -->
<div id="detailModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeDetailModal()">&times;</span>
        <h2>Chi Tiết Thanh Toán</h2>
        <div id="paymentDetails" class="detail-content">
            <!-- Dữ liệu sẽ được thêm động bởi JS -->
        </div>
    </div>
</div>

<script>
    let currentId = null;

    function approveRegistration(id) {
        alert(`Đã duyệt hồ sơ ID: ${id}`);
        document.querySelector(`tr[data-id="${id}"] td:nth-child(5)`).textContent = 'Đã Duyệt';
    }

    function openRejectModal(id) {
        currentId = id;
        document.getElementById('rejectModal').style.display = 'block';
        document.getElementById('rejectReason').value = '';
    }

    function closeRejectModal() {
        document.getElementById('rejectModal').style.display = 'none';
    }

    function submitReject() {
        const reason = document.getElementById('rejectReason').value;
        if (reason.trim() === '') {
            alert('Vui lòng nhập lý do!');
            return;
        }
        alert(`Đã từ chối hồ sơ ID: ${currentId} với lý do: ${reason}`);
        document.querySelector(`tr[data-id="${currentId}"] td:nth-child(5)`).textContent = 'Từ Chối';
        closeRejectModal();
    }

    function openDetailModal(id) {
        currentId = id;
        const paymentDetails = document.getElementById('paymentDetails');
        paymentDetails.innerHTML = ''; // Xóa dữ liệu cũ

        // Lấy thông tin từ bảng chính
        const row = document.querySelector(`tr[data-id="${id}"]`);
        const auction = row.cells[0].textContent;
        const documentUrl = row.cells[1].querySelector('a').href;
        const user = row.cells[2].textContent;
        const deposit = row.cells[3].textContent;
        const status = row.cells[4].textContent;

        // Dữ liệu mẫu cho chi tiết thanh toán
        const payment = {
            auction: auction,
            documentUrl: documentUrl,
            user: user,
            deposit: deposit,
            status: status,
            paymentMethod: 'Chuyển Khoản Ngân Hàng',
            paymentDate: '2025-10-10',
            paymentStatus: 'Chưa Hoàn Tiền',
            paymentId: 1
        };

        // Hiển thị thông tin theo chiều dọc
        const details = `
            <div><label>Phiên Đấu Giá:</label> ${payment.auction}</div>
            <div><label>Tài Liệu Liên Quan:</label> <a href="${payment.documentUrl}">${payment.documentUrl.split('/').pop()}</a></div>
            <div><label>User:</label> ${payment.user}</div>
            <div><label>Tiền Đặt Trước:</label> ${payment.deposit}</div>
            <div><label>Trạng Thái Hồ Sơ:</label> ${payment.status}</div>
            <div><label>Phương Thức Thanh Toán:</label> ${payment.paymentMethod}</div>
            <div><label>Ngày Thanh Toán:</label> ${payment.paymentDate}</div>
            <div><label>Trạng Thái Hoàn Tiền:</label> ${payment.paymentStatus}</div>
            <div><button class="refund" onclick="refundPayment(${payment.paymentId})">Hoàn Tiền</button></div>
        `;
        paymentDetails.innerHTML = details;
        document.getElementById('detailModal').style.display = 'block';
    }

    function closeDetailModal() {
        document.getElementById('detailModal').style.display = 'none';
    }

    function refundPayment(paymentId) {
        alert(`Đã hoàn tiền cho thanh toán ID: ${paymentId} thuộc hồ sơ ${currentId}`);
        // Cập nhật trạng thái hoàn tiền trong modal
        const paymentDetails = document.getElementById('paymentDetails');
        const statusDiv = paymentDetails.querySelector('div:nth-child(8)'); // Trạng thái hoàn tiền
        if (statusDiv) {
            statusDiv.innerHTML = `<label>Trạng Thái Hoàn Tiền:</label> Đã Hoàn Tiền`;
        }
        // Vô hiệu hóa nút hoàn tiền
        const refundButton = paymentDetails.querySelector('button.refund');
        if (refundButton) {
            refundButton.disabled = true;
            refundButton.style.backgroundColor = '#ccc';
        }
    }

    // Đóng modal khi click ngoài
    window.onclick = function(event) {
        const rejectModal = document.getElementById('rejectModal');
        const detailModal = document.getElementById('detailModal');
        if (event.target === rejectModal) {
            closeRejectModal();
        } else if (event.target === detailModal) {
            closeDetailModal();
        }
    }
</script>

</body>
</html>